---
title: "argon-visualization"
author: "Robert Jankowski"
date: "16/10/2019"
output: html_document
---

```{r setup, include=FALSE}
# E_mean od tau
# H od t
# E_k, V, P od t

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gridExtra)
```

### Testing stability
```{r}
stability <- read.csv("output/stability.csv", header = F)
colnames(stability) <- c("tau", "H", "P", "T")
head(stability)
```

```{r, fig.width=15, fig.height=4}
h <- ggplot(stability) + geom_point(aes(tau, H)) + scale_x_log10() + labs(title = "Hamiltonian") + theme_light()
p <- ggplot(stability) + geom_point(aes(tau, P)) + scale_x_log10() + labs(title = "Pressure") + theme_light()
t <- ggplot(stability) + geom_point(aes(tau, T)) + scale_x_log10() + labs(title = "Temperature") + theme_light()

# ggsave(filename = "stability.png", grid.arrange(h, p, t, nrow = 1), width = 12, height = 4)
grid.arrange(h, p, t, nrow = 1)
```



```{r}
# library(latex2exp)
tau_e6 <- read.csv("output/5_1_out_tau=1e-6.csv", header = F)
tau_e2 <- read.csv("output/5_1_out_tau=1e-2.csv", header = F)
tau_e3 <- read.csv("output/5_1_out_tau=1e-3.csv", header = F)


colnames(tau_e6) <- c("t", "H", "V", "T", "P")
colnames(tau_e2) <- c("t", "H", "V", "T", "P")
colnames(tau_e3) <- c("t", "H", "V", "T", "P")
```

### Hamiltonian
```{r, fig.width=10, fig.height=5}
h_compare <- ggplot(tau_e2, aes(t, H)) +
    geom_point(aes(color = "tau = 10^-2")) +
    geom_point(data = tau_e3, aes(color = "tau = 10^-3")) +
    geom_point(data = tau_e6, aes(color = "tau = 10^-6"), alpha = 0.2) +
    labs(x = "t [ps]", y = "H [kJ/mol]", title = "Hamiltonian") +
    theme_light()

# ggsave(filename = "h_compare.png", h_compare, width = 12, height = 6)
h_compare 
```

### Temperature
```{r, fig.width=10, fig.height=5}
t_compare <- ggplot(tau_e2, aes(t, T)) +
    geom_point(aes(color = "tau = 10^-2")) +
    geom_point(data = tau_e6, aes(color = "tau = 10^-6")) +
    geom_point(data = tau_e3, aes(color = "tau = 10^-3")) +
    labs(x = "t [ps]", y = "T [K]", title = "Temperature") +
    theme_light()

# ggsave(filename = "t_compare.png", t_compare, width = 12, height = 6)
t_compare
```

### Pressure
```{r, fig.width=10, fig.height=5}
p_compare <- ggplot(tau_e2, aes(t, P)) +
    geom_point(aes(color = "tau = 10^-2")) +
    geom_point(data = tau_e6, aes(color = "tau = 10^-6")) +
    geom_point(data = tau_e3, aes(color = "tau = 10^-3")) +
    labs(x = "t [ps]", y = "P [x 16.6 atm.]", title = "Pressure") +
    theme_light()

# ggsave(filename = "p_compare.png", p_compare, width = 12, height = 6)
p_compare
```


## 5.2 Kryształ
```{r}
a_testing <- read.csv("output/a_testing.csv", header = F)
colnames(a_testing) <- c("a", "V")
```

```{r}
a_min <- a_testing %>%
    filter(V == min(a_testing$V))
a_min
```


```{r}
ggplot(a_testing) +
    geom_point(aes(a, V)) +
    geom_vline(xintercept = a_min$a, color = "red") + 
    labs(x = "a [nm]", y = "V [kJ/mol]", title = "Testing proper `a`") + 
    theme_light()
```


```{r}
testing_T_mean <- read.csv("output/5_2_out_tau=1e-4.csv", header = T)
colnames(testing_T_mean) <- c("t", "H", "V", "T", "P")
```

```{r}
ggplot(testing_T_mean) +
    geom_point(aes(t, T), alpha = 0.3) + 
    labs(x = "t [ps]", y = "T [K]") +
    theme_light()
```

## 5.3 Topnienie kryształu 

```{r}
T070 <- read.csv("output/5_3_out_T0=70.0.csv", header = T)
T080 <- read.csv("output/5_3_out_T0=80.0.csv", header = T)
T090 <- read.csv("output/5_3_out_T0=90.0.csv", header = T)
T0100 <- read.csv("output/5_3_out_T0=100.0.csv", header = T)

colnames(T070) <- c("t", "H", "V", "T", "P")
colnames(T080) <- c("t", "H", "V", "T", "P")
colnames(T090) <- c("t", "H", "V", "T", "P")
colnames(T0100) <- c("t", "H", "V", "T", "P")
```

```{r, fig.width=12, fig.height=5}
ggplot() +
    geom_point(data = T070, aes(t, T, color = "70K")) +
    geom_point(data = T080, aes(t, T, color = "80K")) +
    geom_point(data = T090, aes(t, T, color = "90K")) +
    geom_point(data = T0100, aes(t, T, color = "100K")) +
    theme_light()
```

## 5.4 Gaz

### Finding right `S0`

```{r}
s0_testing <- read.csv("output/5_4_S0_testing.csv", header = T)
```

```{r}
ggplot(s0_testing) + 
    geom_point(aes(S0, T)) +
    theme_light()
```


```{r}
ggplot(s0_testing) + 
    geom_point(aes(S0, P)) +
    theme_light()
```

```{r}
S0200 <- read.csv("output/5_4_out_S0=200.0.csv", header = F)
S0400 <- read.csv("output/5_4_out_S0=400.0.csv", header = F)
S01000 <- read.csv("output/5_4_out_S0=1000.0.csv", header = F)
S01400 <- read.csv("output/5_4_out_S0=1400.0.csv", header = F)
S02000 <- read.csv("output/5_4_out_S0=2000.0.csv", header = F)
S02200 <- read.csv("output/5_4_out_S0=2200.0.csv", header = F)

colnames(S0200) <- c("t", "H", "V", "T", "P")
colnames(S0400) <- c("t", "H", "V", "T", "P")
colnames(S01000) <- c("t", "H", "V", "T", "P")
colnames(S01400) <- c("t", "H", "V", "T", "P")
colnames(S02000) <- c("t", "H", "V", "T", "P")
colnames(S02200) <- c("t", "H", "V", "T", "P")
```

```{r, fig.width=12, fig.height=5}
ggplot() + 
    geom_point(data = S0200, aes(t, P, color = "So=200"), alpha = 0.2) +
    geom_point(data = S0400, aes(t, P, color = "So=400"), alpha = 0.2) +
    geom_point(data = S01000, aes(t, P, color = "So=1000"), alpha = 0.2) +
    geom_point(data = S01400, aes(t, P, color = "So=1400"), alpha = 0.2) +
    geom_point(data = S02000, aes(t, P, color = "So=2000"), alpha = 0.2) +
    geom_point(data = S02200, aes(t, P, color = "So=2200"), alpha = 0.2) +
    theme_light()
```


```{r, fig.width=12, fig.height=5}
ggplot() + 
    geom_point(data = S0200, aes(t, T, color = "So=200"), alpha = 0.2) +
    geom_point(data = S0400, aes(t, T, color = "So=400"), alpha = 0.2) +
    geom_point(data = S01000, aes(t, T, color = "So=1000"), alpha = 0.2) +
    geom_point(data = S01400, aes(t, T, color = "So=1400"), alpha = 0.2) +
    geom_point(data = S02000, aes(t, T, color = "So=2000"), alpha = 0.2) +
    geom_point(data = S02200, aes(t, T, color = "So=2200"), alpha = 0.2) +
    theme_light()
```
